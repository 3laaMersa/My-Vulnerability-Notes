# Password Reset Poisonin

## **Manipulating Password Reset Emails :**

### Scenario:

- A web application sends password reset emails with a link that includes the hostname specified in the `Host` header.

### Attack:

1. The attacker initiates a password reset for a victim's account.
2. The attacker intercepts the request and modifies the `Host` header:

```php
POST /reset-password HTTP/1.1
Host: attacker.com
Content-Type: application/x-www-form-urlencoded
```

1. The application generates a password reset link using the manipulated `Host` header and sends it to the victim's email:

```php
https://attacker.com/reset?token=abcdef
```

1. The victim clicks the link, thinking it’s legitimate, and is redirected to the attacker's site. The attacker captures the reset token and uses it to reset the victim’s password.

### Impact:

- Account takeover, as the attacker now has control over the victim’s account.

---

### Mitigation Strategies

1. **Strict Header Validation**:
    - Ensure the `Host` header is validated against a whitelist of allowed hostnames.
    - Reject requests with invalid or unexpected `Host` headers.
2. **Use Absolute URLs**:
    - Generate password reset links using absolute URLs that are hardcoded or configured in a secure manner, independent of the `Host` header.
3. **Email Content Security**:
    - Ensure that email content and links are carefully reviewed and sanitized to prevent injection attacks.
4. **Monitor and Log**:
    - Monitor and log all requests with unusual `Host` headers for further analysis and potential mitigation.
5. **Multi-Factor Authentication (MFA)**:
    - Implement MFA to add an extra layer of security, even if a password reset link is compromised.
