# Information Disclosure

## Example 1: Internal IP Address Disclosure

### Scenario:

- A web application is configured to disclose internal IP addresses based on the `Host` header.

### Attack:

1. The attacker sends a request with a manipulated `Host` header to discover internal IP addresses:
    
    ```
    GET / HTTP/1.1
    Host: internal-ip-disclosure.example.com
    ```
    
2. The application constructs an internal URL using the `Host` header:
    
    ```
    Location: <http://internal-ip-disclosure.example.com/home>
    ```
    
3. The application responds with a message that includes the internal IP address:
    
    ```
    Welcome to the internal site at 192.168.1.10
    ```
    

### Impact:

- The attacker gains knowledge of the internal network structure, which can be used for further attacks.

## Example 2: Exposure of Internal Hostnames

### Scenario:

- A web application uses the `Host` header to determine the internal hostname for routing purposes and inadvertently exposes it.

### Attack:

1. The attacker manipulates the `Host` header:
    
    ```
    GET /info HTTP/1.1
    Host: internal-hostname.example.com
    ```
    
2. The application constructs a response that includes the internal hostname:
    
    ```
    Internal server: internal-hostname
    ```
    

### Impact:

- The attacker learns about internal hostnames, which could be used for social engineering or other attacks.

## Example 3: Error Page Disclosure

### Scenario:

- A web application displays error pages that include internal server information based on the `Host` header.

### Attack:

1. The attacker manipulates the `Host` header to trigger an error page:
    
    ```
    GET /nonexistent HTTP/1.1
    Host: attacker.com
    ```
    
2. The application responds with an error page that includes internal information:
    
    ```
    404 Not Found
    Server: internal-server.example.com
    ```
    

### Impact:

- The attacker learns about internal server details, which can be used for further reconnaissance.

---

### Mitigation Strategies for Information Disclosure

1. **Strict Header Validation**:
    - Validate the `Host` header against a whitelist of allowed hostnames.
    - Reject requests with invalid or unexpected `Host` headers.
2. **Minimal Disclosure**:
    - Avoid including sensitive information in responses, especially based on user-controlled headers.
    - Ensure error messages and debug information do not reveal internal details.
3. **Configuration Management**:
    - Securely manage configuration files and avoid exposing them through the application.
    - Use environment variables and secure storage solutions for sensitive configuration details.
4. **Logging and Monitoring**:
    - Log all requests with unusual `Host` headers and monitor for suspicious activity.
    - Implement alerts for potential information disclosure attempts.
5. **Regular Security Audits**:
    - Conduct regular security audits and penetration tests to identify and mitigate information disclosure vulnerabilities.

By understanding these examples and implementing robust mitigation strategies, applications can better protect against information disclosure vulnerabilities caused by host header manipulation.
