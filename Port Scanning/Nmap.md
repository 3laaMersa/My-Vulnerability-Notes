# Nmap

### why nmap :

discover hosts and services on a computer network , detect operating systems, identify open ports, and collect information about different network devices .

***Nmap in normal case :*** scan 1000 port only

`nmap [Scan Type(s)] [Options (switch)] {target specification}`
we can see all Options

```sh
[root@kali]# nmap -hh
```

**1. Scan a System with Hostname and IP Address**

```bash
 [root@kali]# nmap 192.168.1.1
 [root@kali]# nmap example.com
```

**2. Scan using “-v” option**
You can see that the below command with “-v” option is giving more detailed information about the remote machine.

```bash
 [root@kali]# nmap -v 192.168.1.1
```

**Result:**

```bash
Initiating Ping Scan at 02:16
Scanning 192.168.1.1 [4 ports]
Completed Ping Scan at 02:16, 0.04s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 02:16
Completed Parallel DNS resolution of 1 host. at 02:16, 8.17s elapsed
Initiating SYN Stealth Scan at 02:16
Scanning 192.168.1.1 [1000 ports]
Discovered open port 22/tcp on 192.168.1.1
Discovered open port 80/tcp on 192.168.1.1
Discovered open port 53/tcp on 192.168.1.1
Discovered open port 23/tcp on 192.168.1.1
Discovered open port 1900/tcp on 192.168.1.1
Completed SYN Stealth Scan at 02:16, 4.45s elapsed (1000 total ports)
Nmap scan report for 192.168.1.1
Host is up (0.024s latency).
Not shown: 995 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
23/tcp   open  telnet
53/tcp   open  domain
80/tcp   open  http
1900/tcp open  upnp

```

**3. Scan OS information and Traceroute**

```bash
[root@kali]# nmap -A 192.168.1.1
```

**Result:**

```bash
Nmap scan report for 192.168.1.1
Host is up (0.052s latency).
Not shown: 995 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     Dropbear sshd 2017.75 (protocol 2.0)
23/tcp   open  telnet  BusyBox telnetd 1.14.0 or later (TP-LINK router telnetd)
53/tcp   open  domain  dnsmasq 2.79
| dns-nsid:
|_  bind.version: dnsmasq-2.79
80/tcp   open  http    TP-LINK WAP http config
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
1900/tcp open  upnp    Portable SDK for UPnP devices 1.6.19 (Linux 2.6.36; UPnP 1.0)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.31 - 2.6.35
Network Distance: 2 hops
Service Info: OS: Linux; Devices: broadband router, WAP; CPE: cpe:/o:linux:linux_kernel, cpe:/o:linux:linux_kernel:2.6.36

TRACEROUTE (using port 1720/tcp)
HOP RTT       ADDRESS
1   65.00 ms  192.168.50.183
2   113.00 ms 192.168.1.1

OS and Service detection performed
```

**4. Enable OS Detection with Nmap ( like -A)**
Use the option “-O” and “-osscan-guess” also helps to discover OS information.

```bash
[root@kali]# nmap -O 192.168.1.1
```

**Result:**

```bash
Nmap scan report for 192.168.1.1
Host is up (0.029s latency).
Not shown: 995 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
23/tcp   open  telnet
53/tcp   open  domain
80/tcp   open  http
1900/tcp open  upnp
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.31 - 2.6.35
Network Distance: 2 hops

```

**5. Scan a Host to Detect Firewall**
The below command will perform a scan on a remote host to detect if any packet filters or Firewall is used by host.

```bash
[root@kali]# nmap -sA 192.168.1.1
```

**Result:**

```bash
Nmap scan report for 192.168.1.1
Host is up (0.019s latency).
All 1000 scanned ports on 192.168.1.1 are in ignored states.
Not shown: 1000 unfiltered tcp ports (reset)

Nmap done: 1 IP address (1 host up) scanned in 14.13 seconds
```

**You can see more Options  with** `nmap -hh`

### **Examples**

1. `[root@kali]# nmap -sT -sU 192.168.1.1`
in normal case nmap scan most 1000 popular port with TCP but with switch -sT -sU , it can scan most 1000 popular port with TCP and UDP .
2. `[root@kali]# nmap -sT -sU --top-ports 2000 192.168.1.1`
nmap scan most 2000 popular port .
3. `[root@kali]# nmap -p 80,443 192.168.1.1`
nmap scan only port 80 and 443
4. `[root@kali]# nmap -p 1-65535 192.168.1.1`
nmap scan port from port 1 to port 65535
