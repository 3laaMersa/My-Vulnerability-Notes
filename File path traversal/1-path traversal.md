# File/Directory path traversal

## **what is:**

File or directory path traversal, also known as directory climbing or directory traversal attack, is a security vulnerability that allows an attacker to access files and directories that are stored outside the web root folder. By manipulating variables that reference files with `dot-dot-slash (../)` sequences and its variations, attackers can traverse to directories and access files that are not intended to be accessible.

## How It Works

1. **User Input:** The attacker finds a user input field that directly or indirectly references a file.
2. **Malicious Input:** The attacker inputs a path traversal string such as `../../../../../etc/passwd` to traverse directories.
3. **Execution:** The web application does not properly sanitize the input, allowing the traversal string to be processed.
4. **Access:** The attacker gains access to files or directories outside the intended directory.

## dot dot slash (../) 
`../` -> its mead the Directory move one level back towards the root directory .
 **for example :**
 the `C:\Windows\Log\Config\..\..\` equl to  `C:\Windows` 
* On Windows operating sytem 
`..\..\..\windows\win.ini` 
* On Windows, both `../` and `..\` are valid directory traversal sequences
* On Unix-based operating systems
`../../../etc/passwd`



## Linux filesystem and directory structure
```
📁 /
├── 📁 bin
│   ├── ⚙️ ls
│   └── ⚙️ bash
├── 📁 boot
│   ├── 💾 vmlinuz
│   └── 💾 initrd.img
├── 📁 dev
│   ├── 💿 sda1
│   └── 💿 sdb
├── 📁 etc
│   ├── 🛠️ passwd
│   └── 🛠️ fstab
├── 📁 home
│   ├── 📁 james
│   │   ├── 🛠️ .bashrc
│   │   ├── 📁 documents
│   │   └── 📁 .ssh
│   │       ├── 🔐 id_rsa
│   │       └── 🔑 authorized_keys
│   └── 📁 traw
│       ├── 🛠️ .profile
│       ├── 📁 pictures
│       └── 📁 .ssh
│           ├── 🔐 id_rsa
│           └── 🔑 authorized_keys
├── 📁 lib
│   ├── ⚙️ http://libc.so
│   └── ⚙️ http://libm.so
├── 📁 media
│   ├── 📁 cdrom
│   └── 📁 usb
├── 📁 mnt
│   └── 📁 mymount
├── 📁 opt
│   └── 📁 myapp
├── 📁 proc
│   ├── 📄 cpuinfo
│   └── 📄 meminfo
├── 📁 root
│   ├── 🛠️ .bash_history
│   └── 📁 .ssh
│       ├── 🔐 id_rsa
│       └── 🔑 authorized_keys
├── 📁 run
│   ├── 📄 utmp
│   └── 📄 systemd
├── 📁 sbin
│   ├── ⚙️ init
│   └── ⚙️ reboot
├── 📁 srv
│   └── 📁 myservice
├── 📁 sys
│   ├── 📄 devices
│   └── 📄 firmware
├── 📁 tmp
│   ├── 📄 temp1
│   └── 📄 temp2
├── 📁 usr
│   ├── 📁 bin
│   │   ├── ⚙️ perl
│   │   └── ⚙️ python
│   ├── 📁 lib
│   │   ├── ⚙️ http://libssl.so
│   │   └── ⚙️ http://libcrypto.so
│   └── 📁 local
│       ├── 📁 bin
│       ├── 📁 lib
│       └── 📁 share
└── 📁 var
    ├── 📁 log
    │   ├── 📄 syslog
    └── 📄 auth.log
    ├── 📁 mail
    ├── 📁 run
    ├── 📁 spool
    └── 📁 www
```
## Example

- Imagine a web application that serves files based on user input, like so:

```bash
http://example.com/showfile?filename=report.txt
```

- If the application is vulnerable to path traversal, an attacker could modify the URL to:

```bash
http://example.com/showfile?filename=../../../../etc/passwd
```

This could grant access to the `/etc/passwd` file on a Unix-based system, which contains user account information.

## Mitigation

1. **Input Validation:** Ensure that user input is validated and sanitized to allow only expected values.
2. **Use of Secure APIs**: Use file APIs that do not allow navigation to parent directories using relative paths.
3. **Access Controls:** Implement proper access controls to restrict user access to only necessary files and directories.
4. **Configuration:** Configure the web server to disallow the execution of scripts or the reading of files from outside the web root directory.
5. **File System Permissions:** Ensure that the web application has the minimum necessary permissions to read or write files.
